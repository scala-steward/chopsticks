package dev.chopsticks.kvdb.util

import dev.chopsticks.kvdb.util.RocksdbUtils
import org.scalatest.{Matchers, WordSpecLike}

class RocksdbUtilsTest extends WordSpecLike with Matchers {
  "parseOptions" should {
    "parse" in {
      val testOptions = IoUtils.resource("rocksdb-test-options")
      val sections = RocksdbUtils.parseOptions(testOptions.getLines().toTraversable)
      testOptions.close()

      sections.map { s =>
        (s.name, s.values.size)
      } should equal(
        List(
          ("Version", 2),
          ("DBOptions", 55),
          ("""CFOptions "default"""", 44),
          ("""TableOptions/BlockBasedTable "default"""", 19),
          ("""CFOptions "lookup"""", 43),
          ("""TableOptions/BlockBasedTable "lookup"""", 19)
        )
      )
    }
  }
}
